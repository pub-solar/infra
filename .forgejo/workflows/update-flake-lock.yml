name: Update flake lock
on:
  workflow_dispatch:
  schedule:
    - cron: "33 3 * * 6" # “At 03:33 on Saturday.”

jobs:
  update_lockfile:
    runs-on: self-hosted
    steps:
      - name: nix flake update
        uses: https://git.momo.koeln/momo/forgejo-action-update-flake@d6ea6c225de116446061e4269ce3faf564b9d08d
        with:
          forgejo_access_token: ${{ secrets.HAKKONAUT_ACCESS_TOKEN }}
          gpg_private_key: ${{ secrets.GPG_SIGN_SUBKEY }}
          gpg_fingerprint: F39BE7813956AB92C3821DFBC02540B6C5BD80EE
          gpg_passphrase: ${{ secrets.GPG_PASSPHRASE }}
          git_author: '"hakkonaut" <no-reply@pub.solar>'
          closure-diff-nixos-configuration: nachtigall
